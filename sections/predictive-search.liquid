{% comment %}theme-check-disable ImgLazyLoading{% endcomment %}
{%- if predictive_search.performed -%}
  <div id='predictive-search-results' role='listbox'>
    {%- if predictive_search.resources.products.size > 0 -%}
      <div id='predictive-search-results-groups-wrapper' class='predictive-search__results-groups-wrapper'>
        <div class='predictive-search__result-group'>
          <div>
            <h2
              id='predictive-search-products'
              class='predictive-search__heading text-body caption-with-letter-spacing'
            >
              {{- 'templates.search.products' | t -}}
            </h2>
            <ul
              id='predictive-search-results-products-list'
              class='predictive-search__results-list list-unstyled'
              role='group'
              aria-labelledby='predictive-search-products'
            >
              {%- for product in predictive_search.resources.products -%}
                <li
                  id='predictive-search-option-product-{{ forloop.index }}'
                  class='predictive-search__list-item'
                  role='option'
                  aria-selected='false'
                >
                  <a
                    href='{{ product.url }}'
                    class='predictive-search__item predictive-search__item--link-with-thumbnail link link--text'
                    tabindex='-1'
                  >
                    {%- if product.featured_media != blank -%}
                      <img
                        class='predictive-search__image'
                        src='{{ product.featured_media | image_url: width: 150 }}'
                        alt='{{ product.featured_media.alt | escape }}'
                        width='50'
                        height='{{ 50 | divided_by: product.featured_media.preview_image.aspect_ratio }}'
                      >
                    {%- endif -%}
                    <div class='predictive-search__item-content{% unless settings.predictive_search_show_vendor or settings.predictive_search_show_price %} predictive-search__item-content--centered{% endunless %}'>
                      {%- if settings.predictive_search_show_vendor -%}
                        <span class='visually-hidden'>{{ 'accessibility.vendor' | t }}</span>
                        <div class='predictive-search__item-vendor caption-with-letter-spacing'>
                          {{ product.vendor }}
                        </div>
                      {%- endif -%}
                      <p class='predictive-search__item-heading h5'>{{ product.title | escape }}</p>
                      {%- if settings.predictive_search_show_price -%}
                        {% render 'price', product: product, use_variant: true, show_badges: false %}
                      {%- endif -%}
                    </div>
                  </a>
                </li>
              {%- endfor -%}
            </ul>
          </div>
        </div>
      </div>
    {%- endif -%}

    {%- if predictive_search.terms != blank -%}
      <div class='predictive-search__result-group'>
        <h2 class='predictive-search__heading text-body caption-with-letter-spacing'>Related Terms</h2>
        <ul class='predictive-search__results-list list-unstyled' role='group'>
          {%- assign search_terms = predictive_search.terms | split: ' ' -%}
          {%- for term in search_terms -%}
            <li class='predictive-search__list-item' role='option'>
              <button
                class='predictive-search__item predictive-search__item--term link link--text'
                tabindex='-1'
                data-search-term='{{ term }}'
              >
                <span>{{ term }}</span>
              </button>
            </li>
          {%- endfor -%}
        </ul>
      </div>
    {%- endif -%}

    {%- render 'loading-spinner', class: 'predictive-search__loading-state' -%}

    <div id='predictive-search-option-search-keywords' class='predictive-search__search-for-button'>
      <button
        class='predictive-search__item predictive-search__item--term link link--text h5 animate-arrow'
        tabindex='-1'
        role='option'
        aria-selected='false'
      >
        <span data-predictive-search-search-for-text>
          {{- 'templates.search.search_for' | t: terms: predictive_search.terms -}}
        </span>
        <span class='svg-wrapper'>
          {{- 'icon-arrow.svg' | inline_asset_content -}}
        </span>
      </button>
    </div>
  </div>

  <span class='hidden' data-predictive-search-live-region-count-value>
    {% liquid
      if predictive_search.resources.products.size == 0
        echo 'templates.search.no_results' | t: terms: predictive_search.terms
      else
        echo 'templates.search.results_products_with_count' | t: count: predictive_search.resources.products.size
      endif
    %}
  </span>
{%- endif -%}
