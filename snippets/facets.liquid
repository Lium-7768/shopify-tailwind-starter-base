{%- liquid
  assign is_show_sortby = is_show_sortby | default: true
  assign is_show_display = is_show_display | default: true
-%}

<facet-filters-form class="">
  <form
    class="twcss-flex twcss-justify-between twcss-items-center twcss-h-[60px] twcss-bg-gray-50 rounded-[5px] twcss-px-5 twcss-py-2 twcss-max-w-[1280px] twcss-mx-auto"
    id="FacetSortForm"
  >
    {%- assign sort_by = collection.sort_by | default: collection.default_sort_by -%}

    <!-- Left Section -->
    <div class="twcss-flex twcss-items-center twcss-gap-4">
      {% if is_show_sortby %}
        <div class="twcss-flex twcss-items-center twcss-gap-[10px]">
          <span class="twcss-text-[14px]">Sorted By:</span>
          <div class="twcss-relative">
            <select
              name="sort_by"
              class="twcss-appearance-none twcss-text-[14px] twcss-h-11 twcss-bg-white twcss-border twcss-border-gray-300 twcss-rounded twcss-py-1 twcss-pl-3 twcss-pr-8 twcss-cursor-pointer focus:twcss-outline-none"
              id="SortBy"
              aria-describedby="a11y-refresh-page-message"
            >
              {%- for option in collection.sort_options -%}
                <option
                  class="twcss-text-[14px]"
                  value="{{ option.value | escape }}"
                  {% if option.value == sort_by %}
                    selected="selected"
                  {% endif %}
                >
                  {{ option.name | escape }}
                </option>
              {%- endfor -%}
            </select>
            <div class="twcss-pointer-events-none twcss-absolute twcss-inset-y-0 twcss-right-0 twcss-flex twcss-items-center twcss-px-2">
              <svg
                class="twcss-h-4 twcss-w-4 twcss-text-gray-400"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </div>
          </div>
        </div>
      {% endif %}
      <div class="twcss-text-[14px]">{{ collection.products_count }} total records</div>
    </div>

    <!-- Middle Section -->
    {% render 'pagination', paginate: paginate %}

    <!-- Right Section -->
    <div class="twcss-flex twcss-items-center twcss-gap-4">
      <div class="twcss-flex twcss-items-center twcss-gap-[10px]">
        <span class="twcss-text-gray-600 twcss-text-[14px]">Per page:</span>
        <div class="twcss-relative">
          <select
            name="page_size"
            class="twcss-appearance-none twcss-text-[14px] twcss-h-11 twcss-bg-white twcss-border twcss-border-gray-300 twcss-rounded twcss-py-1 twcss-pl-3 twcss-pr-8 twcss-cursor-pointer focus:twcss-outline-none"
          >
            <option value="12" selected>12</option>
            <option value="24">24</option>
            <option value="48">48</option>
          </select>
          <div class="twcss-pointer-events-none twcss-absolute twcss-inset-y-0 twcss-right-0 twcss-flex twcss-items-center twcss-px-2">
            <svg class="twcss-h-4 twcss-w-4 twcss-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </div>
        </div>
      </div>

      {% if is_show_display %}
        <div class="twcss-flex twcss-items-center twcss-gap-[10px]">
          <span class="twcss-text-gray-600 twcss-text-[14px]">Display:</span>
          <div class="twcss-flex twcss-gap-[10px]">
            <button
              type="button"
              class="twcss-p-[11px] twcss-text-gray-600 twcss-h-11 twcss-border twcss-border-gray-300 twcss-rounded hover:twcss-bg-gray-50"
              data-view="list"
            >
              {% render 'icon-list-view' %}
            </button>
            <button
              type="button"
              class="twcss-p-[11px] twcss-text-blue-600 twcss-h-11 twcss-border twcss-border-blue-600 twcss-rounded twcss-bg-blue-50"
              data-view="grid"
            >
              {% render 'icon-grid-view' %}
            </button>
          </div>
        </div>
      {% endif %}
    </div>
  </form>

  <!-- Filter Section -->
  <div class="!twcss-bg-white !twcss-shadow-sm !twcss-rounded-lg !twcss-border !twcss-border-gray-200 !twcss-overflow-hidden">
    <div class="!twcss-flex !twcss-items-center !twcss-justify-between !twcss-py-4 !twcss-px-4 !twcss-border-b !twcss-border-gray-200">
      <h2 class="!twcss-text-lg !twcss-font-medium">Filter by</h2>
      <button type="button" class="!twcss-text-sm !twcss-text-blue-600 !twcss-hover:text-blue-500">Clear All</button>
    </div>

    <details
      id="Details-{{ filter.param_name | escape }}-{{ section.id }}"
      class="mobile-facets__details js-filter {% if filter_type == 'horizontal' %}disclosure-has-popup facets__disclosure{% else %} facets__disclosure-vertical{% endif %} !twcss-mb-4"
    >
      <summary class="mobile-facets__summary focus-inset !twcss-flex !twcss-items-center !twcss-justify-between !twcss-py-2 !twcss-px-4 !twcss-bg-white !twcss-border !twcss-border-gray-200 !twcss-rounded-md">
        <div class="!twcss-text-sm !twcss-font-medium">{{ filter.label | escape }}</div>
        <span class="!twcss-transform !twcss-transition-transform" :class="{ '!twcss-rotate-180': open }">
          <svg class="!twcss-w-4 !twcss-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
          </svg>
        </span>
      </summary>

      <div class="!twcss-relative !twcss-mb-4">
        <input
          type="search"
          class="!twcss-w-full !twcss-px-3 !twcss-py-2 !twcss-border !twcss-border-gray-200 !twcss-rounded-md !twcss-text-sm"
          placeholder="Search"
        >
        <span class="!twcss-absolute !twcss-right-3 !twcss-top-1/2 !twcss-transform !twcss--translate-y-1/2">
          <svg class="!twcss-w-4 !twcss-h-4 !twcss-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </span>
      </div>

      {% for value in filter.values %}
        <label
          for="{{ input_id }}"
          class="!twcss-flex !twcss-items-center !twcss-py-2 !twcss-px-2 !twcss-text-sm !twcss-text-gray-600 !twcss-hover:bg-gray-50"
        >
          <input
            type="checkbox"
            name="{{ value.param_name }}"
            value="{{ value.value }}"
            id="{{ input_id }}"
            class="!twcss-h-4 !twcss-w-4 !twcss-rounded !twcss-border-gray-300 !twcss-text-blue-600 focus:!twcss-ring-blue-500"
            {% if value.active %}
              checked
            {% endif %}
            {% if is_disabled %}
              disabled
            {% endif %}
          >
          <span class="!twcss-ml-2">{{ value.label | escape }} ({{ value.count }})</span>
        </label>
      {% endfor %}
    </details>
  </div>
</facet-filters-form>
