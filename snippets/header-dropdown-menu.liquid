{% comment %}
  Renders a standard dropdown style menu for the header.

  Usage:
  {% render 'header-dropdown-menu' %}
{% endcomment %}

{%- assign raw_icons = section.settings.menu_icons | strip -%}
{%- assign cleaned_icons = raw_icons | remove: '\"' | remove: '""' | default: '{}' -%}
{%- assign menu_icons = cleaned_icons | json -%}

<!-- Debug output -->
<div style="display: none;">
  <p>Raw icons: {{ raw_icons }}</p>
  <p>Cleaned icons: {{ cleaned_icons }}</p>
  <p>Menu icons: {{ menu_icons }}</p>
  {%- for link in section.settings.menu.links -%}
    <p>Link handle: {{ link.handle }}</p>
    <p>Icon for handle: {{ menu_icons[link.handle] }}</p>
  {%- endfor -%}
</div>

<nav class="twcss-relative">
  <ul class="twcss-flex twcss-flex-wrap twcss-items-center twcss-gap-4" role="list">
    {%- for link in section.settings.menu.links -%}
      <li>
        <a href="{{ link.url }}" class="twcss-inline-flex twcss-items-center twcss-gap-2 twcss-px-3 twcss-py-2 twcss-text-gray-700 hover:twcss-text-gray-900 focus:twcss-outline-none focus:twcss-ring-2 focus:twcss-ring-offset-2 focus:twcss-ring-primary-500">
          {%- if menu_icons[link.handle] != blank -%}
            <span class="twcss-size-6">
              {%- assign icon_name = menu_icons[link.handle] -%}
              <!-- Debug icon name -->
              <span style="display: none;">Loading icon: {{ icon_name }}</span>
              {{ icon_name | inline_asset_content }}
            </span>
          {%- endif -%}
          <span>{{ link.title | escape }}</span>
        </a>
      </li>
    {%- endfor -%}
  </ul>
</nav>
