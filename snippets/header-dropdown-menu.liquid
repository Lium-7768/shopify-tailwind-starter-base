{% comment %}
  Renders a standard dropdown style menu for the header.

  Usage:
  {% render 'header-dropdown-menu' %}
{% endcomment %}

{%- assign raw_icons = section.settings.menu_icons | strip -%}
{%- assign cleaned_icons = raw_icons | remove: '\"' | remove: '""' | default: '{}' -%}
{%- assign menu_icons_string = cleaned_icons -%}

<nav class="twcss-relative">
  <ul class="twcss-flex twcss-flex-wrap twcss-items-center twcss-gap-4" role="list">
    {%- for link in section.settings.menu.links -%}
      <li>
        <a href="{{ link.url }}" class="twcss-inline-flex twcss-items-center twcss-gap-2 twcss-px-3 twcss-py-2 twcss-text-gray-700 hover:twcss-text-gray-900 focus:twcss-outline-none focus:twcss-ring-2 focus:twcss-ring-offset-2 focus:twcss-ring-primary-500">
          {%- assign icon_key = '"' | append: link.handle | append: '":"' -%}
          {%- if menu_icons_string contains icon_key -%}
            {%- assign icon_part = menu_icons_string | split: icon_key | last -%}
            {%- assign icon_name = icon_part | split: '"' | first -%}
            <span class="twcss-size-6">
              {{ icon_name | inline_asset_content }}
            </span>
          {%- endif -%}
          <span>{{ link.title | escape }}</span>
        </a>
      </li>
    {%- endfor -%}
  </ul>
</nav>

<!-- Debug output -->
<div style="display: none;">
  <p>Raw icons: {{ raw_icons }}</p>
  <p>Cleaned icons: {{ cleaned_icons }}</p>
  <p>Menu icons string: {{ menu_icons_string }}</p>
  {%- for link in section.settings.menu.links -%}
    <p>Link handle: {{ link.handle }}</p>
    {%- assign icon_key = '"' | append: link.handle | append: '":"' -%}
    {%- if menu_icons_string contains icon_key -%}
      {%- assign icon_part = menu_icons_string | split: icon_key | last -%}
      {%- assign icon_name = icon_part | split: '"' | first -%}
      <p>Icon for handle: {{ icon_name }}</p>
    {%- endif -%}
  {%- endfor -%}
</div>
